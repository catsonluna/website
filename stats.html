
<html lang="en">    
    <meta charset="UTF-8"/>
    <head>
        <title>Pinkulu</title>
        <link rel="stylesheet" href="limitDataStyle.css"/>
        <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.2/dist/chart.min.js"></script>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
		<meta property="og:title" content="Pinkulu">
        <meta property="og:description" content="Statistics for the mod HeightLimitMod.">
        <meta property="og:image" content="https://pinkulu.com/images/logo.png">
        <meta property="og:url" content="https://pinkulu.com/stats.html">
    </head>

    <body>
        <div class="main" id="main">
            <nav>
                <div class="logo">  
                    <img src="images/logo.png">
                </div>
                <div class="nav-links">
                    <ul>
                        <li><a href="https://pinkulu.com">Home</a></li>
                        <li><a href="mods.html">Mods</a></li>                        
                        <li>
                            <div class="dropdown">
                                <button class="dropbtn">HeightLimitWeb</button>
                                <div class="dropdown-content">
                                    <a href="maps.html">Maps</a>
                                    <a href="stats.html">Statistics</a>
                                </div>
                              </div>
                        </li>                        <li><a href="https://discord.gg/Fykpshg">Discord</a></li>
                        <li><a href="https://github.com/pinkulu">Github</a></li>
                    </ul>
                </div>                
            </nav>
            <div class="container-fluid" id="container-fluid">
                <div class="row">
                    <div class="col-lg-5" id="gamesAllTimeDiv">
                        <h3>Games Played All Time</h3>
                        <canvas class="gamesAllTime" id="gamesAllTime" width="400" height="400"></canvas>
                    </div>
                    <div class="col-lg-5 offset-md-1" id="gamesTodayDiv">
                        <h3>Games Played Today</h3>
                        <canvas class="gamesToday" id="gamesToday" width="400" height="400"></canvas>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-5" id="mapsAllTimeDiv">
                        <h3>Maps Played All Time</h3>
                        <canvas class="mapsAllTime" id="mapsAllTime" width="400" height="400"></canvas>
                    </div>
                    <div class="col-lg-5 offset-md-1" id="mapsTodayDiv">
                        <h3>Maps Played Today</h3>
                        <canvas class="mapsToday" id="mapsToday" width="400" height="400"></canvas>
                    </div>
                </div>
            </div>
            <p>data collected since: 2021-04-08</p>
        <script>
            fetch('https://api.pinkulu.com/HeightLimitMod/BedWars/data')
            .then(response => response.json())
            .then(data => {
                // Games Played All Time
                document.getElementById("gamesAllTimeDiv").innerHTML += 
                `<p>Solo/Doubles: ${data["solo/doubles"]["total"]["TotalCalls"]}</p>
                 <p>3v3v3v3/4v4v4v4: ${data["3v3v3v3/4v4v4v4"]["total"]["TotalCalls"]}</p>
                 <p>Total: ${data["solo/doubles"]["total"]["TotalCalls"] + data["3v3v3v3/4v4v4v4"]["total"]["TotalCalls"]}</p>`
                 document.getElementById('container-fluid').innerHTML += `
                                    <p>Server Date: ${data['server_time']['date']}</p>
                                    <p>Server Time: ${data['server_time']['time']}</p>
                                `
                var ctx = document.getElementById('gamesAllTime').getContext('2d');
                var played = []
                var myChart = new Chart(ctx, {
                    type: 'pie',
                    draw: function(){
                        this.scale.endPoint = 200;
                        Chart.types.Bar.prototype.draw.apply(this, arguments);  
                    },
                    data: {
                        labels: ['solo/doubles', '3v3v3v3/4v4v4v4'],
                        datasets: [{
                            label: 'Played Games',
                            data: [data["solo/doubles"]["total"]["TotalCalls"], data["3v3v3v3/4v4v4v4"]["total"]["TotalCalls"]],
                            backgroundColor: [
                                'rgba(61, 203, 106, 0.2)',
                                'rgba(149, 61, 203, 0.2)',
                                'rgba(255, 206, 86, 0.2)',
                                'rgba(75, 192, 192, 0.2)',
                                'rgba(153, 102, 255, 0.2)',
                                'rgba(255, 159, 64, 0.2)'
                            ],
                            borderColor: [
                                'rgba(255, 255, 255, 0.2)',
                                'rgba(255, 255, 255, 0.2)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });

                let obj1 = data["3v3v3v3/4v4v4v4"]["total"];
                let obj2 = data["solo/doubles"]["total"];
                let labels = [];
                let dataset = [];


                let combined = {...obj1, ...obj2};
                delete combined.TotalCalls;

                for (let key of Object.keys(combined)) {
                  labels.push(key);
                  dataset.push(combined[key]);
                }

                var ctx = document.getElementById('mapsAllTime').getContext('2d');
                var myChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Maps Played All Time',
                            data: dataset,
                            backgroundColor: [
                                'rgba(255, 159, 64, 0.2)',
                                'rgba(153, 102, 255, 0.2)',
                                'rgba(255, 206, 86, 0.2)',
                                'rgba(75, 192, 192, 0.2)',
                                'rgba(153, 102, 255, 0.2)',
                                'rgba(255, 159, 64, 0.2)'
                            ],
                            borderColor: [
                                'rgba(255, 99, 132, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });

                document.getElementById("gamesTodayDiv").innerHTML += 
                `<p>Solo/Doubles: ${data["solo/doubles"][`${data['server_time']['date']}`]["total"]["TotalCalls"]}</p>
                 <p>3v3v3v3/4v4v4v4: ${data["3v3v3v3/4v4v4v4"][`${data['server_time']['date']}`]["total"]["TotalCalls"]}</p>
                 <p>Total: ${data["solo/doubles"][`${data['server_time']['date']}`]["total"]["TotalCalls"] + data["3v3v3v3/4v4v4v4"][`${data['server_time']['date']}`]["total"]["TotalCalls"]}
                    </p>`
                var ctx = document.getElementById('gamesToday').getContext('2d');
                var played = []
                var myChart = new Chart(ctx, {
                    type: 'pie',
                    draw: function(){
                        this.scale.endPoint = 200;
                        Chart.types.Bar.prototype.draw.apply(this, arguments);  
                    },
                    data: {
                        labels: ['solo/doubles', '3v3v3v3/4v4v4v4'],
                        datasets: [{
                            label: 'Played Games',
                            data: [data["solo/doubles"][`${data['server_time']['date']}`]["total"]["TotalCalls"]
                            , data["3v3v3v3/4v4v4v4"][`${data['server_time']['date']}`]["total"]["TotalCalls"]],
                            backgroundColor: [
                                'rgba(61, 203, 106, 0.2)',
                                'rgba(149, 61, 203, 0.2)',
                                'rgba(255, 206, 86, 0.2)',
                                'rgba(75, 192, 192, 0.2)',
                                'rgba(153, 102, 255, 0.2)',
                                'rgba(255, 159, 64, 0.2)'
                            ],
                            borderColor: [
                                'rgba(255, 255, 255, 0.2)',
                                'rgba(255, 255, 255, 0.2)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });

                //Maps played today
                let obj3 = data["3v3v3v3/4v4v4v4"][`${data['server_time']['date']}`]["total"];
                let obj4 = data["solo/doubles"][`${data['server_time']['date']}`]["total"];
                let labelsToday = [];
                let datasetToday = [];


                let combinedToday = {...obj3, ...obj4};
                delete combinedToday.TotalCalls;

                for (let key of Object.keys(combinedToday)) {
                  labelsToday.push(key);
                  datasetToday.push(combinedToday[key]);
                }
                console.log(labelsToday)
                console.log(datasetToday)

                var ctx = document.getElementById('mapsToday').getContext('2d');
                var myChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labelsToday,
                        datasets: [{
                            label: 'Maps Played Today',
                            data: datasetToday,
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.2)',
                                'rgba(54, 162, 235, 0.2)',
                                'rgba(255, 206, 86, 0.2)',
                                'rgba(75, 192, 192, 0.2)',
                                'rgba(153, 102, 255, 0.2)',
                                'rgba(255, 159, 64, 0.2)'
                            ],
                            borderColor: [
                                'rgba(255, 99, 132, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            })
            </script>
    </body>
</html>